---
name: (WIP) Feed Jekyll posts to Vespa

on:
  workflow_call:
    inputs:
      log_level:
        description: 'Log level for Jekyll build.'
        required: false
        default: 'info'
        type: string
      hook-post-build-script:
        description: |
          Script to run after Jekyll build, can be multi-line.
          Ref: https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idstepsrun
        required: false
        type: string

defaults:
  run:
    # Specify to ensure "pipefail and errexit" are set.
    # Ref: https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#defaultsrunshell
    shell: bash

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Build with Jekyll
        uses: vespa-engine/gh-actions/jekyll-build-json@fix-jekyll-build
        with:
          log_level: ${{ inputs.log_level }}

      - name: Hook - Post-build
        if: ${{ inputs.hook-post-build-script != '' }}
        run: |
          ${{ inputs.hook-post-build-script }}
